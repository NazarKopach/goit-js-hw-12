{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const createGalleryCard = imgInfo => ` <li class=\"gallery-card\">\n      <a href=\"${imgInfo.largeImageURL}\" class=\"gallery-link\">\n        <img class=\"gallery-img\" src=\"${imgInfo.webformatURL}\" alt=\"${imgInfo.tags}\" />\n      </a>\n      <div class=\"info\">\n        <p><strong>Likes:</strong> ${imgInfo.likes}</p>\n        <p><strong>Views:</strong> ${imgInfo.views}</p>\n        <p><strong>Comments:</strong> ${imgInfo.comments}</p>\n        <p><strong>Downloads:</strong> ${imgInfo.downloads}</p>\n      </div>\n    </li>`;","import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com';\n\nexport const fetchPhotos = (searchQuery, page) => {\n  const axiosOption = {\n    params: {\n      q: searchQuery,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: page,\n      per_page: 15,\n      key: '45516244-7009a6d8a44aa98a2987db7ac',\n    },\n  };\n\n  return axios.get(`/api/`, axiosOption);\n};","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport { createGalleryCard } from './js/render-functions';\nimport { fetchPhotos } from './js/pixabay-api';\n\nconst searchForm = document.querySelector('.search-form');\nconst galleryEl = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst btnLoadMore = document.querySelector('.load-more-btn');\n\nlet searchValue = '';\nlet currentPage = 1;\nlet totalHits = 0;\nlet loadedHits = 0;\nlet cardHeight = 0;\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst onSearchFormSubmit = async event => {\n  try {\n    event.preventDefault();\n\n    searchValue = searchForm.elements.user_query.value.trim();\n\n    if (!searchValue) {\n      galleryEl.innerHTML = '';\n      searchForm.reset();\n      return;\n    }\n\n    currentPage = 1;\n    totalHits = 0;\n    loadedHits = 0;\n    galleryEl.innerHTML = '';\n    searchForm.reset();\n    loader.classList.remove('is-hidden');\n\n    const response = await fetchPhotos(searchValue, currentPage);\n\n    if (response.data.hits.length === 0) {\n      iziToast.error({\n        message:\n          'There are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      btnLoadMore.classList.add('is-hidden');\n      loader.classList.add('is-hidden');\n      return;\n    }\n\n    totalHits = response.data.totalHits;\n    loadedHits = response.data.hits.length;\n\n    const galleryCardsTemplate = response.data.hits\n      .map(imgDetails => createGalleryCard(imgDetails))\n      .join('');\n    galleryEl.insertAdjacentHTML('beforeend', galleryCardsTemplate);\n    lightbox.refresh();\n\n    const galleryCardEl = galleryEl.querySelector('li');\n    cardHeight = galleryCardEl.getBoundingClientRect().height;\n\n    if (loadedHits < totalHits) {\n      btnLoadMore.classList.remove('is-hidden');\n    } else {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n      btnLoadMore.classList.add('is-hidden');\n    }\n\n  } catch (err) {\n    console.log(err);\n  } finally {\n    loader.classList.add('is-hidden');\n  }\n};\n\nconst onLoadMoreClick = async event => {\n  try {\n    currentPage++;\n\n    const response = await fetchPhotos(searchValue, currentPage);\n\n    loadedHits += response.data.hits.length;\n\n    const galleryCardsTemplate = response.data.hits\n      .map(imgDetails => createGalleryCard(imgDetails))\n      .join('');\n    galleryEl.insertAdjacentHTML('beforeend', galleryCardsTemplate);\n    lightbox.refresh();\n\n    scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    })\n\n    if (loadedHits >= totalHits) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n      btnLoadMore.classList.add('is-hidden');\n    }\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nsearchForm.addEventListener('submit', onSearchFormSubmit);\nbtnLoadMore.addEventListener('click', onLoadMoreClick);\n"],"names":["createGalleryCard","imgInfo","axios","fetchPhotos","searchQuery","page","axiosOption","searchForm","galleryEl","loader","btnLoadMore","searchValue","currentPage","totalHits","loadedHits","cardHeight","lightbox","SimpleLightbox","onSearchFormSubmit","event","response","iziToast","galleryCardsTemplate","imgDetails","err","onLoadMoreClick"],"mappings":"+vBAAO,MAAMA,EAAoBC,GAAW;AAAA,iBAC3BA,EAAQ,aAAa;AAAA,wCACEA,EAAQ,YAAY,UAAUA,EAAQ,IAAI;AAAA;AAAA;AAAA,qCAG7CA,EAAQ,KAAK;AAAA,qCACbA,EAAQ,KAAK;AAAA,wCACVA,EAAQ,QAAQ;AAAA,yCACfA,EAAQ,SAAS;AAAA;AAAA,WCN1DC,EAAM,SAAS,QAAU,sBAElB,MAAMC,EAAc,CAACC,EAAaC,IAAS,CAChD,MAAMC,EAAc,CAClB,OAAQ,CACN,EAAGF,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAU,GACV,IAAK,oCACN,CACL,EAEE,OAAOH,EAAM,IAAI,QAASI,CAAW,CACvC,ECbMC,EAAa,SAAS,cAAc,cAAc,EAClDC,EAAY,SAAS,cAAc,UAAU,EAC7CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,gBAAgB,EAE3D,IAAIC,EAAc,GACdC,EAAc,EACdC,EAAY,EACZC,EAAa,EACbC,EAAa,EAEbC,EAAW,IAAIC,EAAe,aAAc,CAC9C,aAAc,MACd,aAAc,GAChB,CAAC,EAED,MAAMC,EAAqB,MAAMC,GAAS,CACxC,GAAI,CAKF,GAJAA,EAAM,eAAc,EAEpBR,EAAcJ,EAAW,SAAS,WAAW,MAAM,KAAI,EAEnD,CAACI,EAAa,CAChBH,EAAU,UAAY,GACtBD,EAAW,MAAK,EAChB,MACD,CAEDK,EAAc,EACdC,EAAY,EACZC,EAAa,EACbN,EAAU,UAAY,GACtBD,EAAW,MAAK,EAChBE,EAAO,UAAU,OAAO,WAAW,EAEnC,MAAMW,EAAW,MAAMjB,EAAYQ,EAAaC,CAAW,EAE3D,GAAIQ,EAAS,KAAK,KAAK,SAAW,EAAG,CACnCC,EAAS,MAAM,CACb,QACE,oEACF,SAAU,UAClB,CAAO,EACDX,EAAY,UAAU,IAAI,WAAW,EACrCD,EAAO,UAAU,IAAI,WAAW,EAChC,MACD,CAEDI,EAAYO,EAAS,KAAK,UAC1BN,EAAaM,EAAS,KAAK,KAAK,OAEhC,MAAME,EAAuBF,EAAS,KAAK,KACxC,IAAIG,GAAcvB,EAAkBuB,CAAU,CAAC,EAC/C,KAAK,EAAE,EACVf,EAAU,mBAAmB,YAAac,CAAoB,EAC9DN,EAAS,QAAO,EAGhBD,EADsBP,EAAU,cAAc,IAAI,EACvB,sBAAuB,EAAC,OAE/CM,EAAaD,EACfH,EAAY,UAAU,OAAO,WAAW,GAExCW,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,UAClB,CAAO,EACDX,EAAY,UAAU,IAAI,WAAW,EAGxC,OAAQc,EAAK,CACZ,QAAQ,IAAIA,CAAG,CACnB,QAAY,CACRf,EAAO,UAAU,IAAI,WAAW,CACjC,CACH,EAEMgB,EAAkB,MAAMN,GAAS,CACrC,GAAI,CACFP,IAEA,MAAMQ,EAAW,MAAMjB,EAAYQ,EAAaC,CAAW,EAE3DE,GAAcM,EAAS,KAAK,KAAK,OAEjC,MAAME,EAAuBF,EAAS,KAAK,KACxC,IAAIG,GAAcvB,EAAkBuB,CAAU,CAAC,EAC/C,KAAK,EAAE,EACVf,EAAU,mBAAmB,YAAac,CAAoB,EAC9DN,EAAS,QAAO,EAEhB,SAAS,CACP,IAAKD,EAAa,EAClB,SAAU,QAChB,CAAK,EAEGD,GAAcD,IAChBQ,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,UAClB,CAAO,EACDX,EAAY,UAAU,IAAI,WAAW,EAExC,OAAQc,EAAK,CACZ,QAAQ,IAAIA,CAAG,CAChB,CACH,EAEAjB,EAAW,iBAAiB,SAAUW,CAAkB,EACxDR,EAAY,iBAAiB,QAASe,CAAe"}